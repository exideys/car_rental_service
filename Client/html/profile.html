<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
</head>
<body>
<h2>Профіль користувача</h2>
<p>Ім’я:   <span id="profile-name"></span></p>
<p>Email: <span id="profile-email"></span></p>
</body>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        fetch('/api/current_user')
            .then(res => {
                if (!res.ok) throw new Error("Unauthorized");
                return res.json();
            })
            .then(renderProfile)
            .catch(() => {
                window.location.href = "/html/login.html";
            });
    });

    function renderProfile(user) {
        document.querySelector('#profile-name').textContent =
            user.username ?? `${user.first_name} ${user.last_name}`;
        document.querySelector('#profile-email').textContent = user.email;
    }
</script>
</html>